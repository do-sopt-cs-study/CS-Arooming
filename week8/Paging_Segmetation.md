# 📑 페이징 & 세그먼테이션: 가상 메모리 관리 방법과 성능 향상 기법

## 💬 페이지와 세그먼테이션

- 다중 프로그래밍 시스템에서 다수의 프로세스를 수용하기 위해 주 기억장치를 동적으로 분할하는 메모리 관리 작업이 필요함.
    - 메모리를 어떻게 적재할 지를 결정할 때, 페이지와 세그먼테이션을 사용함.

## 💬 메모리 관리

### 💭 연속 메모리 관리

- 프로그램 전체가 하나의 커다란 공간에 연속적으로 할당되는 방법
- `고정 분할 기법`: 주 기억 장치가 고정된 파티션으로 분할되어 **내부 단편화** 발생
- `동적 분할 기법`: 파티션들이 동적 생성되며 자신의 크기와 같은 파티션에 적재되어 **외부 단편화** 발생
- 둘 중 어떤 기법을 사용하더라도, 연속 메모리 관리 기법을 사용하면 단편화 현상이 발생함.
    - 단편화 현상: 기억 장치의 빈 공간 또는 자료가 여러 조각으로 나뉘는 현상을 의미함.
        - 프로세스들이 메모리에 적재되고 제거되는 일 반복 → 각 프로세스들이 차지하는 메모리 틈 사이에 사용하지 못하는 만큼의 공간이 늘어나게 됨.

### 💭 내부 단편화

- 프로세스가 하는 메모리 공간 내의 **남는 부분**
- 프로세스가 요청한 양보다 더 많은 메모리를 할당할 때 발생
- 메모리 분할 자유 공간과 프로세스가 사용하는 공간의 크기 차이를 의미함.

![](https://media.vlpt.us/images/gang_shik/post/1a6c123d-8ba6-4c19-b42c-23fdb8fb5b94/image.png)

### 💭 외부 단편화

- 메모리 공간 중 **사용하지 못하는 부분**
- 메모리 할당 및 해제 작업의 반복으로 작은 메모리가 중간 중간 존재 → 사용하지 않는 메모리로 인해, 총 메모리 공간은 충분하지만 실제로 프로세스를 할당할 수 없는 상황
- 외부 단편화 해결을 위해 압축을 이용하여 프로세스가 사용하는 공간을 한 쪽으로 몰 수 있지만, 작업 효율이 좋지 않음.

![](https://media.vlpt.us/images/gang_shik/post/d44423b3-59c9-48e9-9408-8d0fb686d5ad/image.png)

---

## 💬 불연속 메모리 관리

- 프로그램 일부가 서로 다른 주소 공간에 할당될 수 있는 기법
    - 단편화 문제를 해결하기 위해 제시됨.
    - 세그먼테이션 - 내부 단편화 해소
    - 페이징 - 외부 단편화 해소
    

### 💭 페이징 (Paging)

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/yaaix/btrEdsK3PPJ/0U6gkxhlTGah6p0kg4mrL1/img.png)

- 프로세스를 `일정한 크기의 페이지`로 분할하여 메모리에 적재하는 방식
    - **페이지**: 작은 고정 크기의 프로세스 조각
- 연속적이지 않은 공간도 활용할 수 있음 → 외부 단편화 문제 해결
- `메모리는 frame`이라는 고정크기로 분할되고, `프로세스는 page`라는 고정크기로 분할됨.
- 페이지 크기 === 프레임 크기
- 페이지와 프레임을 대응시키는 page mapping 과정이 필요하기 때문에, page table을 생성해야 함.
- page table에는 각 페이지 번호와 해당 페이지가 할당된 프레임의 시작 물리 주소 저장
- 단점
    - 프로세스의 크기가 페이지 크기의 배수가 아닐 경우, 마지막 페이지에 내부 단편화 발생
    - 페이지 크기가 클수록 내부 단편화 커짐
    - 페이지 단위를 작게하면 내부 단편화 문제도 해결할 수 있지만, 그만큼 page mapping 과정이 많아지기 때문에 효율 저하

### 💭 세그먼테이션 (Segmentation)

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/22MDs/btrEcQMrq7W/FoKKXCHIBOvfcsu9YvU18k/img.png)

- 프로세스를 `세그먼트`로 분할하여 메모리에 할당
    - **세그먼트**: 서로 크기가 다른 논리적 블록 단위
- 각 세그먼트는 연속적인 공간에 저장됨.
- 세그먼트들의 `크기가 서로 다르기 때문에`, 프로세스가 메모리에 적재될 때 빈 공간을 찾아 할당하는 기법
- 페이징과 마찬가지로 매핑을 위한 segment table이 필요함.
- 단점
    - 프로세스가 필요한 공간만큼 메모리를 할당해주기 때문에, 내부 단편화 문제는 발생하지 않음.
    - 중간에 메모리를 해제하면 외부 단편화 문제 발생

### 💭 페이징 (Paging) vs 세그먼테이션 (Segmentation)

- **페이징 (Paging)**
    - 고정크기를 가짐.
    - 내부 단편화 발생 가능
- **세그먼테이션 (Segmentation)**
    - 가변크기를 가짐.
    - 외부 단편화 발생 가능